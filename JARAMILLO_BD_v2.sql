-------------------------------- DROP ORIGINAL TABLES --------------------------------
DROP TABLE APP_USER;

DROP TABLE USER_TYPE;

DROP TABLE USER_STATUS;

DROP TABLE VERIFICATIONTOKEN;
-------------------------------- CREATE NEW TABLES --------------------------------
CREATE TABLE USER_TYPE(
	user_type_id 	    VARCHAR(32)		            NOT NULL PRIMARY KEY,
	name				VARCHAR(50)		        NOT NULL UNIQUE,
	updated_at		    DATE					    NOT NULL,
	deleted				NUMERIC(1)			    NOT NULL,
	created_at			DATE					NOT NULL
);

CREATE TABLE USER_STATUS(
    status_id   		VARCHAR(32)		        NOT NULL PRIMARY KEY,
	status      		VARCHAR(32)		    NOT NULL,
	
	updated_at		    DATE					    NOT NULL,
	deleted				NUMERIC(1)			    NOT NULL,
	created_at			DATE					NOT NULL
	
);

CREATE TABLE APP_USER (
	appuser_id		    VARCHAR(32)			    NOT NULL PRIMARY KEY,
	username			VARCHAR(50) 			NOT NULL UNIQUE,
	hash				VARCHAR(255)			NOT NULL,
	email				VARCHAR(50)			    NOT NULL UNIQUE,
	name				VARCHAR(100)			NOT NULL,
	last_names	        VARCHAR(100)			NOT NULL,
    rut                 VARCHAR(13)			    NOT NULL,
	adress				VARCHAR(100),
	phone				VARCHAR(100),
	birthday			DATE,
    lastLogin			DATE					NOT NULL,
    mail_confirmed	    NUMERIC(1)	        	    NOT NULL,
	user_type_id    	VARCHAR(32)	    	    NOT NULL,
	status_id       	VARCHAR(32)	    	    NOT NULL,
	updated_at		    DATE						NOT NULL,
	deleted				NUMERIC(1)				NOT NULL,
	created_at			DATE					NOT NULL
);

ALTER TABLE APP_USER ADD CONSTRAINT user_type_fk FOREIGN KEY(user_type_id) REFERENCES USER_TYPE(user_type_id);
ALTER TABLE APP_USER ADD CONSTRAINT user_status_fk FOREIGN KEY(status_id) REFERENCES USER_STATUS(status_id);

CREATE TABLE VERIFICATIONTOKEN (
	token				VARCHAR(32)			NOT NULL PRIMARY KEY,
	appuser_id		    VARCHAR(50) 		NOT NULL,
	expiry_date		    DATE				NOT NULL
);

ALTER TABLE VERIFICATIONTOKEN ADD CONSTRAINT VARIF_USER_FK FOREIGN KEY(appuser_id) REFERENCES APP_USER(appuser_id);


INSERT INTO USER_TYPE ( USER_TYPE_ID, NAME, CREATED_AT , UPDATED_AT , DELETED ) VALUES('ADM', 'Administrador', SYSDATE, SYSDATE, 0);
INSERT INTO USER_TYPE ( USER_TYPE_ID, NAME, CREATED_AT , UPDATED_AT , DELETED) VALUES('CLI', 'Cliente', SYSDATE, SYSDATE, 0);
INSERT INTO USER_TYPE ( USER_TYPE_ID, NAME, CREATED_AT , UPDATED_AT , DELETED) VALUES('CAJ', 'Cajero', SYSDATE, SYSDATE, 0);
INSERT INTO USER_TYPE ( USER_TYPE_ID, NAME, CREATED_AT , UPDATED_AT , DELETED) VALUES('VEN', 'Vendedor', SYSDATE, SYSDATE, 0);
INSERT INTO USER_TYPE ( USER_TYPE_ID, NAME, CREATED_AT , UPDATED_AT , DELETED) VALUES('SUP', 'Supervisor', SYSDATE, SYSDATE, 0);
INSERT INTO USER_TYPE ( USER_TYPE_ID, NAME, CREATED_AT , UPDATED_AT , DELETED) VALUES('MEC', 'Mecánico', SYSDATE, SYSDATE, 0);
INSERT INTO USER_TYPE ( USER_TYPE_ID, NAME, CREATED_AT , UPDATED_AT , DELETED) VALUES('TES', 'Testing', SYSDATE, SYSDATE, 0);

INSERT INTO USER_STATUS ( STATUS_ID , STATUS , CREATED_AT , UPDATED_AT , DELETED) VALUES('BAN', 'Desactivado', SYSDATE, SYSDATE, 0);
INSERT INTO USER_STATUS ( STATUS_ID , STATUS , CREATED_AT , UPDATED_AT , DELETED) VALUES('ACT', 'Activo', SYSDATE, SYSDATE, 0);


-- ADMIN SEBA
INSERT INTO APP_USER (APPUSER_ID, USERNAME, HASH, EMAIL, NAME, LAST_NAMES, RUT, ADRESS, PHONE, BIRTHDAY, LASTLOGIN, MAIL_CONFIRMED, USER_TYPE_ID, STATUS_ID, UPDATED_AT, DELETED, CREATED_AT)
VALUES(
	SYS_GUID(), -- APPUSER_ID
	'sebaherrera', -- USERNAME
	'42437a69a8fd1d5f3a9d1a01f072187282a663cf327ffbf11412f25ff01cd29a', -- HASH : alfalfa8.
	'seherreraluna@gmail.cl', -- EMAIL
	'Sebastian', -- NAME
	'Herrera Luna', -- LAST_NAMES
    '18.594.857-9',--RUT
	'Calle los Michis #469', -- ADRESS
	'+56966666666', -- PHONE
	TO_DATE('1994/06/18 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), -- BIRTHDAY
	TO_DATE('2020/04/10 20:36:20', 'yyyy/mm/dd hh24:mi:ss'), -- LASTLOGIN
	1, -- MAIL_CONFIRMED
	'ADM', -- USER_TYPE_ID
	'ACT', -- STATUS_ID
	TO_DATE('2020/03/20 09:02:11', 'yyyy/mm/dd hh24:mi:ss'), -- UPDATED_AT
	0, -- DELETED
	TO_DATE('2020/03/20 09:02:11', 'yyyy/mm/dd hh24:mi:ss') -- CREATED_AT
);

-- ADMIN MATI
INSERT INTO APP_USER (APPUSER_ID, USERNAME, HASH, EMAIL, NAME, LAST_NAMES,RUT, ADRESS, PHONE, BIRTHDAY, LASTLOGIN, MAIL_CONFIRMED, USER_TYPE_ID, STATUS_ID, UPDATED_AT, DELETED, CREATED_AT)
VALUES(
	SYS_GUID(), -- APPUSER_ID
	'matiespinoza', -- USERNAME
	'42437a69a8fd1d5f3a9d1a01f072187282a663cf327ffbf11412f25ff01cd29a', -- HASH : mati
	'mati.esp@gmail.cl', -- EMAIL
	'Matias', -- NAME
	'Espinoza', -- LAST_NAMES
    '19.387.716-8',--RUT
	'Calle Campo #69', -- ADRESS
	'+56955555555', -- PHONE
	TO_DATE('1996/05/20 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), -- BIRTHDAY
	TO_DATE('2020/04/10 20:36:20', 'yyyy/mm/dd hh24:mi:ss'), -- LASTLOGIN
	1, -- MAIL_CONFIRMED
	'ADM', -- USER_TYPE_ID
	'ACT', -- STATUS_ID
	TO_DATE('2020/03/20 09:02:11', 'yyyy/mm/dd hh24:mi:ss'), -- UPDATED_AT
	0, -- DELETED
	TO_DATE('2020/03/20 09:02:11', 'yyyy/mm/dd hh24:mi:ss') -- CREATED_AT
);

-- ADMIN IRINA
INSERT INTO APP_USER (APPUSER_ID, USERNAME, HASH, EMAIL, NAME, LAST_NAMES, RUT, ADRESS, PHONE, BIRTHDAY, LASTLOGIN, MAIL_CONFIRMED, USER_TYPE_ID, STATUS_ID, UPDATED_AT, DELETED, CREATED_AT)
VALUES(
	SYS_GUID(), -- APPUSER_ID
	'irinmunoz', -- USERNAME
	'753923b3a91b753ca991116df61a90c06f97721277cb2829b21a4a209f7aa932', -- HASH : irin.munoz
	'irin.munoz@gmail.cl', -- EMAIL
	'Irina', -- NAME
	'Muñoz', -- LAST_NAMES
    '20.124.502-8',--RUT
	'Calle los Dogo #696', -- ADRESS
	'+5697777777', -- PHONE
	TO_DATE('1999/06/01 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), -- BIRTHDAY
	TO_DATE('2020/04/01 20:36:20', 'yyyy/mm/dd hh24:mi:ss'), -- LASTLOGIN
	1, -- MAIL_CONFIRMED
	'ADM', -- USER_TYPE_ID
	'ACT', -- STATUS_ID
	TO_DATE('2020/03/20 09:02:11', 'yyyy/mm/dd hh24:mi:ss'), -- UPDATED_AT
	0, -- DELETED
	TO_DATE('2020/03/20 09:02:11', 'yyyy/mm/dd hh24:mi:ss') -- CREATED_AT
);


-- MECÁNICA CON MAIL CONFIRMADO
INSERT INTO APP_USER (APPUSER_ID, USERNAME, HASH, EMAIL, NAME, LAST_NAMES, RUT, ADRESS, PHONE, BIRTHDAY, LASTLOGIN, MAIL_CONFIRMED, USER_TYPE_ID, STATUS_ID, UPDATED_AT, DELETED, CREATED_AT)
VALUES(
	SYS_GUID(), -- APPUSER_ID
	'ReGarrido', -- USERNAME
	'55648da29f4d04cbddcd9f82f43c26068ffdc63749a6b2bda0b617ab8286dd61', -- HASH : Renata1659
	'rgarrido@gmail.cl', -- EMAIL
	'Renata', -- NAME
	'Garrido Gonzales', -- LAST_NAMES
    '17.359.326-4',--RUT
	'Calle Serrano #14', -- ADRESS
	'+56921659878', -- PHONE
	TO_DATE('1990/05/12 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), -- BIRTHDAY
	TO_DATE('2020/04/09 18:02:43', 'yyyy/mm/dd hh24:mi:ss'), -- LASTLOGIN
	1, -- MAIL_CONFIRMED
	'MEC', -- USER_TYPE_ID
	'ACT', -- STATUS_ID
	TO_DATE('2020/02/18 17:08:11', 'yyyy/mm/dd hh24:mi:ss'), -- UPDATED_AT
	0, -- DELETED
	TO_DATE('2020/02/18 17:08:11', 'yyyy/mm/dd hh24:mi:ss') -- CREATED_AT
);


-- MECÁNICA CON MAIL SIN CONFIRMAR
INSERT INTO APP_USER (APPUSER_ID, USERNAME, HASH, EMAIL, NAME, LAST_NAMES, RUT, ADRESS, PHONE, BIRTHDAY, LASTLOGIN, MAIL_CONFIRMED, USER_TYPE_ID, STATUS_ID, UPDATED_AT, DELETED, CREATED_AT)
VALUES(
	SYS_GUID(), -- APPUSER_ID
	'EdMartinez', -- USERNAME
	'512d71cd1dd152f74cee02d2e6b1be673291529c1557557f97a02ec2f8cc5a58', -- HASH : Renata1659
	'edu.martinez@gmail.cl', -- EMAIL
	'Eduardo', -- NAME
	'Martinez', -- LAST_NAMES
    '15.684.326-0',--RUT
	'Calle las Ilusiones #1965', -- ADRESS
	'+56965987845', -- PHONE
	TO_DATE('1985/02/28 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), -- BIRTHDAY
	TO_DATE('2020/03/25 18:02:43', 'yyyy/mm/dd hh24:mi:ss'), -- LASTLOGIN
	0, -- MAIL_CONFIRMED
	'MEC', -- USER_TYPE_ID
	'ACT', -- STATUS_ID
	TO_DATE('2020/03/25 17:08:11', 'yyyy/mm/dd hh24:mi:ss'), -- UPDATED_AT
	0, -- DELETED
	TO_DATE('2020/03/25 17:08:11', 'yyyy/mm/dd hh24:mi:ss') -- CREATED_AT
);
--MECÁNICO PUBLICACIÓN 1
INSERT INTO APP_USER (APPUSER_ID, USERNAME, HASH, EMAIL, NAME, LAST_NAMES, RUT, ADRESS, PHONE, BIRTHDAY, LASTLOGIN, MAIL_CONFIRMED, USER_TYPE_ID, STATUS_ID, UPDATED_AT, DELETED, CREATED_AT)
VALUES(
	'7CD5B7769DF75CEFE034080020825436', -- APPUSER_ID
	'AutSuzuki', -- USERNAME
	'b905fd76b66e4d0a108d603e27c86989a6b079e3bee1787755929e1ecc2fb359', -- HASH : suzukimotriz
	'automotriz.contacto@gmail.cl', -- EMAIL
	'Raul', -- NAME
	'Cerda Martinez', -- LAST_NAMES
    '12.035.261-5',--RUT
	'Calle los Cardenales #14', -- ADRESS
	'+56921659878', -- PHONE
	TO_DATE('1976/11/02 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), -- BIRTHDAY
	TO_DATE('2020/04/19 12:02:43', 'yyyy/mm/dd hh24:mi:ss'), -- LASTLOGIN
	1, -- MAIL_CONFIRMED
	'MEC', -- USER_TYPE_ID
	'ACT', -- STATUS_ID
	TO_DATE('2020/04/05 19:08:11', 'yyyy/mm/dd hh24:mi:ss'), -- UPDATED_AT
	0, -- DELETED
	TO_DATE('2020/04/05 19:08:11', 'yyyy/mm/dd hh24:mi:ss') -- CREATED_AT
);

--MECÁNICO PUBLICACIÓN 2
INSERT INTO APP_USER (APPUSER_ID, USERNAME, HASH, EMAIL, NAME, LAST_NAMES, RUT, ADRESS, PHONE, BIRTHDAY, LASTLOGIN, MAIL_CONFIRMED, USER_TYPE_ID, STATUS_ID, UPDATED_AT, DELETED, CREATED_AT)
VALUES(
	'7CD5B7769DF85CEFE034080020825436', -- APPUSER_ID
	'KaiserMecanic', -- USERNAME
	'4220bb5fbeae8daa7d1b1b350d55af45a6b6b53488db5ff1ebfb2bc8f778b423', -- HASH : Kaiser1991
	'Kaiser1991@gmail.cl', -- EMAIL
	'Ariana', -- NAME
	'Fernandez Ortega', -- LAST_NAMES
    '18.215.891-k',--RUT
	'Villa san Matin, Melipilla', -- ADRESS
	'+56924521786', -- PHONE
	TO_DATE('1991/01/25 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), -- BIRTHDAY
	TO_DATE('2020/04/18 12:03:26', 'yyyy/mm/dd hh24:mi:ss'), -- LASTLOGIN
	1, -- MAIL_CONFIRMED
	'MEC', -- USER_TYPE_ID
	'ACT', -- STATUS_ID
	TO_DATE('2020/04/18 12:02:43', 'yyyy/mm/dd hh24:mi:ss'), -- UPDATED_AT
	0, -- DELETED
	TO_DATE('2020/04/05 12:02:43', 'yyyy/mm/dd hh24:mi:ss') -- CREATED_AT
);


commit;